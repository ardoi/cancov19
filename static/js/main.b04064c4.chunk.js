(this.webpackJsonpcancov19=this.webpackJsonpcancov19||[]).push([[0],{210:function(e,t,a){e.exports=a(419)},215:function(e,t,a){},216:function(e,t,a){},419:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(38),c=a.n(l),o=(a(215),a(216),a(217),a(22)),i=a(31),u=a(176),s=a(177),m=a(196),d=a(199),h=(a(234),a(40)),p=a(18),f=a.n(p),v=a(66),E=r.a.createContext("CXContext"),g=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={detailData:null,deathData:null,dim:null,loading:!1,hasCF:!1},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(!this.state.hasCF&&!this.state.loading){this.dimensions={},this.dimensionsD={};var t="https://docs.google.com/spreadsheets/d/1C59nxtgcnwGyo6lgypsgN18duxmwWigjeVdKY58t0mU/gviz/tq?tqx=out:csv&sheet=",a=t+"Det",n=t+"Dth";this.setState({loading:!0});var r=function(t){t.forEach((function(e){e.Date=f()(e.Announced+"-2020","D-MMM-YYYY"),e.Total=parseFloat(e.Deaths)})),t=t.filter((function(e){return"RC"!==e.Prov}));var a=Object(v.a)(t),n=JSON.parse(JSON.stringify(t));n.forEach((function(e){e.Date=f()(e.Date)}));var r=Object(v.a)(n);return e.dimensionsD.date=a.dimension((function(e){return e.Date})),e.dimensionsD.dateN=r.dimension((function(e){return e.Date})),e.dimensionsD.prov=a.dimension((function(e){return e.Prov})),e.dimensionsD.provN=r.dimension((function(e){return e.Prov})),t},l=Object(h.c)(a).then((function(t){t.forEach((function(e){e.Date=f()(e.Date+"-2020","D-MMM-YYYY"),e.Total=parseFloat(e.Cases)})),t=t.filter((function(e){return"RC"!==e.Prov}));var a=Object(v.a)(t),n=JSON.parse(JSON.stringify(t));n.forEach((function(e){e.Date=f()(e.Date)}));var r=Object(v.a)(n);return e.dimensions.date=a.dimension((function(e){return e.Date})),e.dimensions.dateN=r.dimension((function(e){return e.Date})),e.dimensions.prov=a.dimension((function(e){return e.Prov})),e.dimensions.provN=r.dimension((function(e){return e.Prov})),t})).catch((function(e){return console.log("failed with url",e),Object(h.c)("https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/1C59nxtgcnwGyo6lgypsgN18duxmwWigjeVdKY58t0mU/gviz/tq?tqx=out:csv&sheet=Det").then(r).catch((function(e){console.log("backuperror 1",e)}))})),c=Object(h.c)(n).then(r).catch((function(e){return console.log("failed with url2",e),Object(h.c)("https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/1C59nxtgcnwGyo6lgypsgN18duxmwWigjeVdKY58t0mU/gviz/tq?tqx=out:csv&sheet=Dth").then(r).catch((function(e){console.log("backuperror 2",e)}))}));Promise.all([l,c]).then((function(t){console.log("Done fetching data"),e.setState({loading:!1,hasCF:!0,detailData:t[0],deathData:t[1]})}))}}},{key:"render",value:function(){return this.state.hasCF?r.a.createElement(E.Provider,{value:{dimensions:this.dimensions,dimensionsD:this.dimensionsD}},r.a.createElement("div",{ref:this.parent},this.props.children)):null}}]),a}(n.Component),w=a(178),y=a(198),k=a(425),O=a(427),C=a(16),b=function(){return[[235,172,35],[184,0,88],[0,140,249],[0,110,0],[0,187,173],[209,99,230],[178,69,2],[255,146,135],[89,84,214],[0,198,248],[135,133,0],[0,167,108],[189,189,189]].map((function(e){return Object(C.g)(e[0],e[1],e[2]).darker().formatHex()}))},D=function(e,t){for(var a=[],n=0;n<e.length;n++)a.push({a1:e[n],a2:t[n]});a.sort((function(e,t){return e.a1.value-t.a1.value}));for(var r=0;r<a.length;r++)e[r]=a[r].a1,t[r]=a[r].a2},P={ON:14.71,QC:8.53,BC:5.11,AB:4.41,SK:1.18,NL:.52,NS:.98,MB:1.38,NB:.78,PE:.16,YT:.041,NT:.044,NU:.039};function j(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}function x(e){return e.reduce((function(e,t){return e+t.Total}),(function(e,t){return e-t.Total}),(function(){return 0}))}function N(e){return e.reduce((function(e,t){return e[t.Prov]=(e[t.Prov]||0)+t.Total,e}),(function(e,t){return e[t.Prov]=e[t.Prov]-t.Total,e}),(function(){return{}}))}var A=function(e){var t=Object(w.css)({cursor:"pointer"});return r.a.createElement(y.a,Object.assign({},t,{onClick:function(){e.chart.filterAll(),o.redrawAll()}}),"reset")},T=function(e){var t,a=r.a.useContext(E),l=r.a.useState(null),c=Object(i.a)(l,2),o=c[0],u=c[1],s=r.a.useState({a:1,b:0}),m=Object(i.a)(s,2),d=m[0],h=m[1];"detail"===e.params.usedata?t=a.dimensions:"deaths"===e.params.usedata&&(t=a.dimensionsD);var p,f,v,g=r.a.useRef(null),w=function(){var e=Object(n.useState)(j()),t=Object(i.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){function e(){r(j())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),a}();return r.a.useEffect((function(){var a=e.chartFunction(g.current,t,e.params,w,d,h);a.render(),u(a)}),[e.params,w]),e.reset&&(p=r.a.createElement(A,{chart:o}),f=r.a.createElement(k.a,{content:"Pick province(s) to filter results and click Reset to restore defaults",trigger:r.a.createElement(y.a,{circular:!0,color:"teal"},"?")})),e.title&&(v=r.a.createElement(O.a,{as:"h3"},e.title,p,f)),r.a.createElement(n.Fragment,null,v,r.a.createElement("div",{ref:g}))},S=function(e,t,a,n,r,l){if(r.hasOwnProperty("chart")){var c=r.chart,i=n.width/1440*350,u=n.width/1440*300;return c.width(i).height(u),c}var s,m=(s=a.normalize?t.provN:t.prov).group(),d=b(),h=x(m).all();D(h,d);var p=o.rowChart(e),f=a.normalize,v=n.width/1440*350,E=n.width/1440*300;return p.width(v).height(E).margins({top:10,right:50,bottom:30,left:40}).dimension(s).group(m).elasticX(!0).labelOffsetX(-25).valueAccessor((function(e){return f?e.value/P[e.key]:e.value})).ordinalColors(d.slice(0,Object.keys(h).length).reverse()),p.xAxis().ticks(5),l({chart:p}),p},M=function(e){return r.a.createElement(T,{chartFunction:S,title:"Province Totals",reset:!0,params:e.params})},z=a(86),F=a(35),Y=a(9),I=function(e,t,a,n,r,l){var c,u,s;if(r.hasOwnProperty("chart")){var m=r.chart,d=n.width/1440*475,h=n.width/1440*350;return m.width(d).height(h),m}a.normalize?(c=t.dateN,u=t.provN.group(),s=c.group()):(c=t.date,u=t.prov.group(),s=c.group());var p=a.stacked,v=s,E=b();if(p){function g(e){return{all:function(){var t,a=e.all(),n={},r=[],l=Object(F.a)(a);try{for(l.s();!(t=l.n()).done;){for(var c=t.value,o=0,u=Object.entries(c.value);o<u.length;o++){var s=Object(i.a)(u[o],2),m=s[0],d=s[1];n[m]=(n[m]||0)+d}r.push({key:c.key,value:Object(z.a)({},n)})}}catch(h){l.e(h)}finally{l.f()}return r}}}v=g(N(s))}else{function g(e){return{all:function(){var t,a=e.all(),n=0,r=[],l=Object(F.a)(a);try{for(l.s();!(t=l.n()).done;){var c=t.value;n+=c.value,r.push({key:c.key,value:n})}}catch(o){l.e(o)}finally{l.f()}return r}}}v=g(x(s))}var w=x(u).all();D(w,E);var y=w[0].key,k=function(e){return function(t){return t.value[e]||0}},O=o.lineChart(e);p?O.dimension(c).group(v,y,k(y)):O.dimension(c).group(v);var C=n.width/1440*475,P=n.width/1440*350;if(O.renderArea(!0).elasticY(!0).width(C).height(P).brushOn(!1).clipPadding(10).margins({left:40,top:10,right:10,bottom:20}).renderDataPoints({radius:2,fillOpacity:1}).xyTipsOn(!0).x(Object(Y.scaleTime)().domain([new Date(2020,2,1),f()().add(1,"day")])).ordinalColors(E).xAxis().ticks(8).tickFormat((function(e){return f()(e).format("DD/MM")})),p){var j,A=Object(F.a)(w.slice(1));try{for(A.s();!(j=A.n()).done;){var T=j.value.key;O.stack(v,T,k(T))}}catch(S){A.e(S)}finally{A.f()}}return l({chart:O}),O},R=function(e){return r.a.createElement(T,{chartFunction:I,title:"Cumulative",params:e.params})},q=function(e,t,a){var n,r,l=t.date;a.total?(n=l.groupAll().reduceSum((function(e){return e.Total})),r=function(e){return e}):(n=x(l.group()),r=function(e){return e.value});var c=o.numberDisplay(e);return c.valueAccessor(r).ordering((function(e){return e.key})).group(n),c},B=function(e){return r.a.createElement(T,{chartFunction:q,title:"",params:e.params})},J=function(e,t,a,n,r,l){var c,i;if(r.hasOwnProperty("chart")){var u=r.chart,s=n.width/1440*475,m=n.width/1440*350;return u.width(s).height(m),u}a.normalize?(c=t.dateN,i=t.provN):(c=t.date,i=t.prov);var d=c.group(),h=a.stacked,p=d,v=x(i.group());p=h?N(d):x(d);var E=function(e){return function(t){return t.value[e]||0}},g=b(),w=v.all();D(w,g);var y=o.lineChart(e),k=w[0].key;h?y.dimension(c).group(p,k,E(k)):y.dimension(c).group(p);var O=n.width/1440*475,C=n.width/1440*350;if(y.renderArea(!0).elasticY(!0).width(O).height(C).brushOn(!1).clipPadding(10).margins({left:40,top:10,right:10,bottom:20}).renderDataPoints({radius:2,fillOpacity:1}).ordinalColors(g).x(Object(Y.scaleTime)().domain([new Date(2020,2,1),f()().add(1,"day")])).xAxis().ticks(5).tickFormat((function(e){return f()(e).format("DD/MM")})),h){var P,j=Object(F.a)(w.slice(1));try{for(j.s();!(P=j.n()).done;){var A=P.value.key;y.stack(p,A,E(A))}}catch(T){j.e(T)}finally{j.f()}}return l({chart:y}),y},W=function(e){return r.a.createElement(T,{chartFunction:J,title:"Daily",params:e.params})},U=function(e,t,a,n,r,l){var c;if(r.hasOwnProperty("chart")){var u=r.chart,s=n.width/1440*475,m=n.width/1440*350;return u.width(s).height(m),u}var d,h;a.normalize?(d=t.dateN,h=t.provN):(d=t.date,h=t.prov);var p,v=d.group(),E=b(),g=v.reduce((function(e,t){return e[t.Prov]=(e[t.Prov]||0)+t.Total/P[t.Prov],e}),(function(e,t){return e[t.Prov]=e[t.Prov]-t.Total/P[t.Prov],e}),(function(){return{}}));var w=(c=g,{all:function(){var e,t=c.all(),a={},n=[],r=Object(F.a)(t);try{for(r.s();!(e=r.n()).done;){for(var l=e.value,o=0,u=Object.entries(l.value);o<u.length;o++){var s=Object(i.a)(u[o],2),m=s[0],d=s[1];a[m]=(a[m]||0)+d}n.push({key:l.key,value:Object(z.a)({},a)})}}catch(h){r.e(h)}finally{r.f()}return n}});p=w;var y=h.group().all();D(y,E);y[0].key;var k=o.compositeChart(e),O=[];y.forEach((function(e,t){var a,n=e.key,r=E[t];O.push(o.lineChart(k).dimension(d).group(p,n,(a=n,function(e){return e.value[a]||0})).colors(r))}));var C=n.width/1440*475,j=n.width/1440*350;return k.elasticY(!0).width(C).height(j).brushOn(!1).clipPadding(10).margins({left:50,top:10,right:10,bottom:20}).x(Object(Y.scaleTime)().domain([new Date(2020,2,1),f()().add(1,"day")])).compose(O),k.xAxis().ticks(5).tickFormat((function(e){return f()(e).format("DD/MM")})),l({chart:k}),k},K=function(e){return r.a.createElement(T,{chartFunction:U,params:e.params})},L=function(e){var t,a=r.a.useContext(E);"detail"===e.params.usedata?t=a.dimensions.date:"deaths"===e.params.usedata&&(t=a.dimensionsD.date);var l=t.group().all(),c=f.a.max(l.map((function(e){return e.key}))).format("D-MMM");return r.a.createElement(n.Fragment,null,c)},V=a(426),G=a(194),H=a(195),X=a(429),Q=a(114),$=a(115),Z=a(116),_=a(117),ee=function(e){var t=[{menuItem:"Stacked",pane:r.a.createElement(V.a.Pane,{attached:"top",key:1},r.a.createElement(R,{params:{stacked:!0,usedata:"detail"}}))},{menuItem:"Total",pane:r.a.createElement(V.a.Pane,{attached:"top",key:2},r.a.createElement(R,{params:{stacked:!1,usedata:"detail"}}))}],a=[{menuItem:"Stacked",pane:r.a.createElement(V.a.Pane,{attached:"top",key:3},r.a.createElement(W,{params:{stacked:!0,usedata:"detail"}}))},{menuItem:"Total",pane:r.a.createElement(V.a.Pane,{attached:"top",key:4},r.a.createElement(W,{params:{stacked:!1,usedata:"detail"}}))}],n=r.a.createElement(G.a,null,r.a.createElement(G.a.Row,{columns:16},r.a.createElement(G.a.Column,{width:4},r.a.createElement(G.a,null,r.a.createElement(H.a,{centered:!0,columns:1},r.a.createElement(G.a.Column,{width:6},r.a.createElement(X.a,{centered:!0,size:"small"},r.a.createElement(Q.a,null,r.a.createElement(B,{params:{usedata:"detail",total:!0}})),r.a.createElement($.a,null,"Total cases"))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(X.a,{size:"small"},r.a.createElement(Q.a,null,r.a.createElement(B,{params:{usedata:"detail",total:!1,date:!0}})),r.a.createElement($.a,null,"New cases"),r.a.createElement($.a,null,"On"," ",r.a.createElement(L,{params:{usedata:"detail"}}))))),r.a.createElement(G.a.Column,{width:16},r.a.createElement(Z.a,null,r.a.createElement(M,{params:{usedata:"detail"}}))))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(V.a,{menu:{secondary:!0,pointing:!0},panes:t,renderActiveOnly:!1})),r.a.createElement(G.a.Column,{width:6},r.a.createElement(V.a,{menu:{secondary:!0,pointing:!0},panes:a,renderActiveOnly:!1}))),r.a.createElement(G.a.Row,{columns:2},r.a.createElement(G.a.Column,null))),l=[{menuItem:"Stacked",pane:r.a.createElement(V.a.Pane,{attached:"top",key:11},r.a.createElement(R,{params:{stacked:!0,usedata:"deaths"}}))},{menuItem:"Total",pane:r.a.createElement(V.a.Pane,{attached:"top",key:12},r.a.createElement(R,{params:{stacked:!1,usedata:"deaths"}}))}],c=[{menuItem:"Stacked",pane:r.a.createElement(V.a.Pane,{attached:"top",key:13},r.a.createElement(W,{params:{stacked:!0,usedata:"deaths"}}))},{menuItem:"Total",pane:r.a.createElement(V.a.Pane,{attached:"top",key:14},r.a.createElement(W,{params:{stacked:!1,usedata:"deaths"}}))}],o=r.a.createElement(G.a,null,r.a.createElement(G.a.Row,{columns:16},r.a.createElement(G.a.Column,{width:4},r.a.createElement(G.a,null,r.a.createElement(H.a,{centered:!0,columns:3},r.a.createElement(G.a.Column,{width:6},r.a.createElement(X.a,{size:"small"},r.a.createElement(Q.a,null,r.a.createElement(B,{params:{usedata:"deaths",total:!0}})),r.a.createElement($.a,null,"Total casualties"))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(X.a,{size:"small"},r.a.createElement(Q.a,null,r.a.createElement(B,{params:{usedata:"deaths",total:!1,date:!0}})),r.a.createElement($.a,null,"New casualties"),r.a.createElement($.a,null,"On"," ",r.a.createElement(L,{params:{usedata:"deaths"}}))))),r.a.createElement(G.a.Column,{width:16},r.a.createElement(Z.a,null,r.a.createElement(M,{params:{usedata:"deaths"}}))))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(V.a,{menu:{secondary:!0,pointing:!0},panes:l,renderActiveOnly:!1})),r.a.createElement(G.a.Column,{width:6},r.a.createElement(V.a,{menu:{secondary:!0,pointing:!0},panes:c,renderActiveOnly:!1}))),r.a.createElement(G.a.Row,{columns:2},r.a.createElement(G.a.Column,null))),i=r.a.createElement(G.a,null,r.a.createElement(H.a,{centered:!0},r.a.createElement(O.a,{as:"h2"},"CASES PER 1M")),r.a.createElement(G.a.Row,{centered:!0,columns:5},r.a.createElement(G.a.Column,{width:4},r.a.createElement(Z.a,null,r.a.createElement(M,{params:{usedata:"detail",normalize:!0}}))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(Z.a,null,r.a.createElement(K,{params:{usedata:"detail",normalize:!0}}))))),u=r.a.createElement(G.a,null,r.a.createElement(H.a,{centered:!0},r.a.createElement(O.a,{as:"h2"},"CASUALTIES PER 1M")),r.a.createElement(G.a.Row,{centered:!0,columns:5},r.a.createElement(G.a.Column,{width:4},r.a.createElement(Z.a,null,r.a.createElement(M,{params:{usedata:"deaths",normalize:!0}}))),r.a.createElement(G.a.Column,{width:6},r.a.createElement(Z.a,null,r.a.createElement(K,{params:{usedata:"deaths",normalize:!0}}))))),s=[{menuItem:"Positive cases",pane:r.a.createElement(V.a.Pane,{attached:"top",key:1},n)},{menuItem:"Casualties",pane:r.a.createElement(V.a.Pane,{attached:"top",key:2},o)},{menuItem:"Cases per million",pane:r.a.createElement(V.a.Pane,{attached:"top",key:3},i)},{menuItem:"Casualties per million",pane:r.a.createElement(V.a.Pane,{attached:"top",key:4},u)}];return r.a.createElement("div",null,r.a.createElement(g,null,r.a.createElement(Z.a,{color:"black",inverted:!0},r.a.createElement(O.a,{color:"yellow",id:"title",textAlign:"center"},r.a.createElement(_.a,{name:"heartbeat"}),"Canada Covid-19 data visualization")),r.a.createElement(Z.a,null,r.a.createElement(V.a,{menu:{secondary:!0,pointing:!0},panes:s,renderActiveOnly:!1})),r.a.createElement(Z.a,{color:"orange"},"Data source:"," ",r.a.createElement("a",{href:"https://virihealth.com/"},"ViriHealth"))))};var te=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(ee,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[210,1,2]]]);
//# sourceMappingURL=main.b04064c4.chunk.js.map